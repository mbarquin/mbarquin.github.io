<!DOCTYPE html><html lang="es-ES"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Publicación de desarrollos, análisis y tests sobre las nuevas librerías y herramientas para la programación PHP"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@mercenariophp"><meta name="twitter:title" content="Retornando objetos de valor en lugar de arrays"><meta name="twitter:description" content="Cuando en una clase necesitamos pasar múltiples datos, ya sea como entrada (parámetros) o como salida (retorno) se tiende a utilizar arrays. Dada su sencillez de manejo y adaptabilidad se utilizan para contener estos valores que son pasados de método a método, o incluso, de clase a clase. Esto hace que el código sea menos estructurado, más difícil de testear y sus errores menos trazables. Estos meses he podido leer varios argumentos a favor del uso de objetos de datos, que conceptualmente, podemos aproximarlos a la implementación de Value Object"><meta name="twitter:image" content="https://www.mercenariophp.comhttps://www.mercenariophp.com/images/mp/mpLogo.png"><meta property="og:title" content="Retornando objetos de valor en lugar de arrays"><meta property="og:description" content="Cuando en una clase necesitamos pasar múltiples datos, ya sea como entrada (parámetros) o como salida (retorno) se tiende a utilizar arrays. Dada su sencillez de manejo y adaptabilidad se utilizan para contener estos valores que son pasados de método a método, o incluso, de clase a clase. Esto hace que el código sea menos estructurado, más difícil de testear y sus errores menos trazables. Estos meses he podido leer varios argumentos a favor del uso de objetos de datos, que conceptualmente, podemos aproximarlos a la implementación de Value Object"><meta property="og:image" content="https://www.mercenariophp.com/images/mp/mpLogo.png"><meta property="og:url" content="https://www.mercenariophp.com/retornando-objetos-valor/"><title>Retornando objetos de valor en lugar de arrays | mercenariophp</title><link rel="stylesheet" type="text/css" href="/css/normalize.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/pure-min.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Retornando objetos de valor en lugar de arrays</h1><a id="logo" href="/.">mercenariophp</a><p class="description">Experimentos y anotaciones de un dev</p></div><div id="nav-menu"><a href="/." class="current"><i class="icon-home"> Inicio</i></a><a href="/archives/"><i class="icon-archive"> Archivo</i></a><a href="/repos/"><i class="icon-github"> Repos</i></a><a href="/mbarquin/"><i class="icon-about"> mbarquin</i></a><a href="/atom.xml"><i class="icon-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">Retornando objetos de valor en lugar de arrays</h1><div class="post-meta">07 / 03 / 2017<span class="categories"> | Guardado en<a href="/categories/Desarrollo/"> Desarrollo</a></span></div><span data-disqus-identifier="retornando-objetos-valor/" class="disqus-comment-count"></span><div class="post-content"><p>Cuando en una clase necesitamos pasar múltiples datos, ya sea como entrada (parámetros) o como salida (retorno) se tiende a utilizar arrays. Dada su sencillez de manejo y adaptabilidad se utilizan para contener estos valores que son pasados de método a método, o incluso, de clase a clase. Esto hace que el código sea menos estructurado, más difícil de testear y sus errores menos trazables. Estos meses he podido leer varios argumentos a favor del uso de objetos de datos, que conceptualmente, podemos aproximarlos a la implementación de <a href="https://en.wikipedia.org/wiki/Value_object" target="_blank" rel="noopener">Value Object</a>. Según la Wikipedia es un pequeño objeto que no es identificado por su clase en si, si no por su equidad, dos value object son iguales cuando contienen los mismos valores (==), no cuando son el mismo objeto (===), su cometido es mantener los datos inmutables para su transporte entre las piezas de la lógica. En realidad es uno de los elementos propios de diseño para Domain Driven Development, creo que podemos abstraer algun concepto de su implementación, como la <strong>inmutabilidad</strong>, para mejorar un poco lo que hacemos. Quizás el concepto sea muy estricto, solo lo voy a utilizar como referente, pero se acerca mucho al sentido de lo que me gustaría implementar.</p>
<a id="more"></a>
<h3 id="Cuando-utilizarlos"><a href="#Cuando-utilizarlos" class="headerlink" title="Cuando utilizarlos"></a>Cuando utilizarlos</h3><p>En general cuando tenemos un retorno complejo de una función que necesitamos estructurar en un array, o, en funciones con muchos parámetros de entrada, condensamos estos datos en las propiedades de un objeto destinado a transportar datos. De esta manera ganamos en control y claridad, tanto del código que se vuelve más verboso, como de la documentación, descrita en el propio fuente del objeto. Pongamos como ejemplo una búsqueda en la tabla de Blog desde un buscador (formulario HTML) con varios conceptos para realizar el filtro, pongamos puede ser acotada en un rango de fechas, puede filtrar un texto entre los títulos de los posts, también filtra por autor y categoría. El código de llamada al modelo podría acabar en algo así.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MyApp</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">blog</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getLastSearchParams</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $finderParams = $_SESSION[<span class="string">'blogLastSeach'</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// $finderParams['dateInit'] = $_SESSION['blogLastSeach']['dateInit'];</span></span><br><span class="line">        <span class="comment">// $finderParams['dateEnd']  = $_SESSION['blogLastSeach']['dateEnd'];</span></span><br><span class="line">        <span class="comment">// $finderParams['dateInit'] = $_SESSION['blogLastSeach']['title'];</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $finderParams;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">findPosts</span><span class="params">($dateInit, $dateEnd, $title, $author, $category, $limit, $page)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Lógica aquí.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Como se puede apreciar en el primer método, la función hace una salida de datos compleja, generalmente esos datos se encapsulan en un array antes de ser devueltos. Pero, podemos reemplazar ese array de salida con un objeto alimentado a partir de los datos de la sesión. hay que hacer notar que al almacenar los valores en la sesión y recuperarlos no tenemos documentación ninguna de los datos que transmitimos al flujo, debemos extrapolarlos del propio código.</p>
<p>También es aplicable en el caso inverso, en el segundo método la búsqueda avanzada dispone de muchos parámetros, si necesitamos incluir también un campo para escoger las tags asociadas a los artículos entre los que buscar, tendríamos que modificar la estructura de la función, su documentación y todos los puntos donde se llama. Es más estructurado y legible asociar los parámetros específicos de la búsqueda a un objeto y los relativos a la paginación en otro. Incluso poniéndonos un poco puristas crearemos un objeto para contener los rangos de fechas.</p>
<p>Comencemos por el objeto de rango de fechas, en el constructor solo comprobamos que el propio rango sea válido, la fecha inicial menor que la final. Le dotamos de getters, constructor y de la función __sleep(). En el ejemplo, si queremos almacenar directamente el objeto en sesión tendremos que declarar el método mágico __sleep(), la sesión se almacena serializada y debemos indicar qué propiedades vamos a almacenar.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MyApp</span>\<span class="title">Value</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">MyApp</span>\<span class="title">Exception</span>\<span class="title">ParametersException</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Class documentation</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DateRange</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> \DateTime Initial Date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $dateInit;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> \DateTime End date</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $dateEnd;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Main constructor</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> \DateTime $dateInit Initial Date</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> \DateTime $dateEnd  End date</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ParameterException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(\DateTime $dateInit, \DateTime $dateEnd)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($dateInit &gt; $dateEnd) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ParametersException(</span><br><span class="line">                    <span class="string">'Date end can\'t be higher than date init'</span></span><br><span class="line">                );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;dateInit = $dateInit;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;dateEnd  = $dateEnd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * date init getter</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \DateTime</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDateInit</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;dateInit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * date end getter</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> \DateTime</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDateEnd</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;dateEnd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Magic method to be called before serialization</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">'dateInit'</span>, <span class="string">'dateEnd'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Ahora es el turno para el objeto de los parámetros de búsqueda. Contendrá el rango de fechas y el resto de parámetros.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MyApp</span>\<span class="title">Value</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">MyApp</span>\<span class="title">Value</span>\<span class="title">DateRange</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Class documentation</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FinderParams</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> DateRange Date Range to search</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $dateRange;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> string Post title</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $title;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> string Post author</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $author;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> integer Category identifier</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> $category_id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Main constructor</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> DateRange $dateRtange  Date Range to search in</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string    $title       Post title</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> string    $author      Post author</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> integer   $category_id Category identifier</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(DateRange $dateRange, $title, $author, $category_id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;dateRange = $dateRange;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;title       = $title;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;author      = $author;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;category_id = $category_id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Magic method to be called before serialization</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">'dateRange'</span>, <span class="string">'title'</span>, <span class="string">'author'</span>, <span class="string">'category_id'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>La verdad que el código puede parecer más complicado, pero en realidad nos garantiza una capa de más de control en la aplicación, el ecosistema de clases se ha vuelto más rico, permitiendo una mejor documentación y testabilidad. Imaginemos que por algún motivo no se pueden realizar búsquedas anteriores al 2013 ya que implementamos una purga de la base de datos borrando la información anterior a X años, afectando a posts, clientes, productos, logs…. El punto habitual para implementar esta validación es en cada modelo que realiza una búsqueda por fechas, ya que suya es la responsabilidad de la lógica de negocio… pero aun así tendremos un punto más de intervención, común a todos los rangos de fechas.</p>
<h3 id="Inmutabilidad"><a href="#Inmutabilidad" class="headerlink" title="Inmutabilidad"></a>Inmutabilidad</h3><p>Como se puede ver los objetos solo disponen de getters, las variables son privadas y se alimentan únicamente desde el constructor. Así, una vez se les ha asignado valor no pueden ser modificadas. Por defecto el paso de objetos entre funciones y clases se realiza por referencia, es decir, siempre se pasa un “enlace” al objeto origen, un cambio en ese enlace se realiza sobre al objeto inicial y por lo tanto afecta los métodos posteriores que lo consuman. Con la inmutabilidad garantizamos que el valor del objeto será siempre el mismo, si es necesario modificar algún valor lo correcto seria devolver una nueva instancia con los valores modificados. <strong>Este comportamiento no es obligatorio, pero me parece útil y podría evitar errores futuros</strong>, la única función de estos objetos es el transporte de sus datos no su modificación. Pensemos por ejemplo que el objeto con el rango de fechas se asigna al template para ser representado en el calendario HTML, si tras ese paso, el valor de estas fechas es modificado en otro método, el HTML reflejará los cambios, ya que al ser renderizado (generalmente el último paso) se utilizará una referencia al objeto origen que ha sido modificado.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setDateEnd</span><span class="params">(\DateTime $dateEnd)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> DateRange(<span class="keyword">$this</span>-&gt;dateInit, $dateEnd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>En el blog de <a href="https://qafoo.com/blog/096_refactoring_extract_data_objects.html" target="_blank" rel="noopener">qafoo</a> anotan un método para refactorizar el código antiguo y reemplazarlo para usar estos objetos. De esta manera podemos cambiar las funciones antiguas encauzando el código a la nueva estructura, sin tener que duplicar la funcionalidad mientras vamos corrigiendo todos los puntos en que se llama a la función.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MyApp</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">MyApp</span>\<span class="title">Value</span>\<span class="title">DateRange</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">MyApp</span>\<span class="title">Value</span>\<span class="title">FinderParams</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">blog</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">findPosts</span><span class="params">($dateInit, $dateEnd, $title, $author, $category_id, $limit, $page)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $params = <span class="keyword">new</span> FinderParams(</span><br><span class="line">                <span class="keyword">new</span> DateRange(</span><br><span class="line">                        <span class="keyword">new</span> \DateTime($dateInit),</span><br><span class="line">                        <span class="keyword">new</span> \DateTime($dateEnd)</span><br><span class="line">                    ),</span><br><span class="line">                $title,</span><br><span class="line">                $author,</span><br><span class="line">                $category_id</span><br><span class="line">            );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;findPostsNew($params, $limit, $page);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">findPostsNew</span><span class="params">(FinderParams $params, $limit, $page)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Lógica aquí.</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Es algo más de trabajo al definir y programar, pero finalmente, estructurar mejor nuestras aplicaciones nos hará ganar tiempo y mejorará su escalabilidad y facilidad de comprensión.</p>
</div><div class="tags"><a href="/tags/PHP/">PHP</a></div><div class="post-nav"><a href="/vacaciones/" class="pre"><i class="icon-previous">Vacaciones</i></a><a href="/tutorial-symfony-bundles-knpmenubundle/" class="next">Tutorial de Symfony 3: Bundles y KnpMenuBundle<i class="icon-next"></i></a></div><div id="disqus_thread"><script>var disqus_shortname = 'mercenariophp';
var disqus_identifier = 'retornando-objetos-valor/';
var disqus_title = 'Retornando objetos de valor en lugar de arrays';
var disqus_url = 'https://www.mercenariophp.com/retornando-objetos-valor/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//mercenariophp.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search" class="search-form-input"><input type="hidden" name="sitesearch" value="https://www.mercenariophp.com"></form></div><div class="widget lessMargin"><div style="text-align: left;"><div style="width: 84px; height: 40px;"><a href="https://twitter.com/mercenariophp" rel="nofollow" target="_blank" class="twitter_big"></a><a href="https://es.linkedin.com/in/moisés-barquín-salgado-b6148296" rel="nofollow" target="_blank" class="linkedin_big"></a></div></div></div><div class="widget"><div class="widget-title">Categorías</div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Desarrollo/">Desarrollo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tutoriales-Symfony/">Tutoriales Symfony</a></li></ul></div><div class="widget"><div class="widget-title">Etiquetas</div><div class="tagcloud"><a href="/tags/tests/" style="font-size: 15px;">tests</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a> <a href="/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/tags/Laravel/" style="font-size: 15px;">Laravel</a> <a href="/tags/PagesGenerator/" style="font-size: 15px;">PagesGenerator</a> <a href="/tags/Herramientas/" style="font-size: 15px;">Herramientas</a> <a href="/tags/Tutorial/" style="font-size: 15px;">Tutorial</a> <a href="/tags/PHPUnit/" style="font-size: 15px;">PHPUnit</a> <a href="/tags/Composer/" style="font-size: 15px;">Composer</a> <a href="/tags/NetBeans/" style="font-size: 15px;">NetBeans</a> <a href="/tags/IDE/" style="font-size: 15px;">IDE</a> <a href="/tags/ReactPHP/" style="font-size: 15px;">ReactPHP</a> <a href="/tags/Slim/" style="font-size: 15px;">Slim</a> <a href="/tags/SQL/" style="font-size: 15px;">SQL</a> <a href="/tags/Pattern/" style="font-size: 15px;">Pattern</a> <a href="/tags/Repositorio/" style="font-size: 15px;">Repositorio</a> <a href="/tags/Frameworks/" style="font-size: 15px;">Frameworks</a></div></div><div class="widget"><div class="widget-title">Recientes</div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/php-dotenv-variables-entorno/">PHP Dotenv, configuración en variables de entorno</a></li><li class="post-list-item"><a class="post-list-link" href="/vacaciones/">Vacaciones</a></li><li class="post-list-item"><a class="post-list-link" href="/retornando-objetos-valor/">Retornando objetos de valor en lugar de arrays</a></li><li class="post-list-item"><a class="post-list-link" href="/tutorial-symfony-bundles-knpmenubundle/">Tutorial de Symfony 3: Bundles y KnpMenuBundle</a></li><li class="post-list-item"><a class="post-list-link" href="/descarga-ficheros-comprimidos-Archivestream-php/">Descarga de ficheros comprimidos con ArchiveStream-php</a></li><li class="post-list-item"><a class="post-list-link" href="/tutorial-symfony-doctrine-orm/">Tutorial de Symfony 3: Doctrine ORM y Base de Datos</a></li><li class="post-list-item"><a class="post-list-link" href="/tutorial-symfony-twig/">Tutorial de Symfony 3: Twig, base layout con Bootstrap</a></li><li class="post-list-item"><a class="post-list-link" href="/tutorial-symfony/">Tutorial de Symfony 3: Instalación, routing y controllers</a></li><li class="post-list-item"><a class="post-list-link" href="/refactorizando-reactphp-slim/">Refactorizando reactphp-slim</a></li><li class="post-list-item"><a class="post-list-link" href="/editor-hackeable-atom/">Editor hackeable Atom, el editor para el siglo 21</a></li></ul></div><div class="widget"><div class="widget-title">Comentarios recientes</div><script type="text/javascript" src="//mercenariophp.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title">Blogroll</div><ul></ul><a href="http://www.phptherightway.com/" title="PHP The Right Way" target="_blank">PHP The Right Way</a></div></div></div></div><div id="footer"><a href="https://twitter.com/mercenariophp" rel="nofollow" class="twitter"></a> <a href="https://es.linkedin.com/in/moisés-barquín-salgado-b6148296" rel="nofollow" class="linkedin"></a> © <a href="/." rel="nofollow">mercenariophp.</a> With<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/jquery.min.js?v=0.0.0"></script><script type="text/javascript" src="/js/totop.js?v=0.0.0"></script><script type="text/javascript" src="/js/fancybox.pack.js?v=0.0.0"></script><script type="text/javascript" src="/js/jquery.fancybox.js?v=0.0.0"></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-78289384-1','auto');ga('send','pageview');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>