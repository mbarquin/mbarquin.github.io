<!DOCTYPE html><html lang="es-ES"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Publicación de desarrollos, análisis y tests sobre las nuevas librerías y herramientas para la programación PHP"><title>ReactPHP, servidor nativo PHP y Slim framework | mercenariophp</title><link rel="stylesheet" type="text/css" href="/css/normalize.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/pure-min.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/grids-responsive-min.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ReactPHP, servidor nativo PHP y Slim framework</h1><a id="logo" href="/.">mercenariophp</a><p class="description">Experimentos y anotaciones de un dev</p></div><div id="nav-menu"><a href="/." class="current"><i class="icon-home"> Inicio</i></a><a href="/archives/"><i class="icon-archive"> Archivo</i></a><a href="/repos/"><i class="icon-github"> Repos</i></a><a href="/mbarquin/"><i class="icon-about"> mbarquin</i></a><a href="/atom.xml"><i class="icon-rss"> RSS</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post post-page"><h1 class="post-title">ReactPHP, servidor nativo PHP y Slim framework</h1><div class="post-meta">29 / 06 / 2016<span class="categories"> | Guardado en<a href="/categories/Desarrollo/"> Desarrollo</a></span></div><span data-disqus-identifier="slim-reactphp-servidor-nativo/" class="disqus-comment-count"></span><div class="post-content"><p><a href="http://reactphp.org/" target="_blank" rel="noopener">ReactPHP</a> es una librería en estado alpha que nos permite implementar programación asíncrona basada en eventos. La parte más conocida es la que <strong>se encarga de levantar un servidor HTTP básico</strong> a partir de un script PHP, sin la necesidad de leer, reinstanciar y tratar el código en cada petición. Al estar ya levantado y preparado para atender las peticiones tampoco hay necesidad de hacer el bootstrap de PHP en cada petición. Es una librería añadida a nuestro proyecto, la cual podemos instanciar para generar un bucle infinito y atender todas las Requests que lleguen a un puerto determinado de la máquina. Gracias a ReactPHP podremos dotar a nuestros proyectos con su propio script de servidor y no depender de terceros para gestionar nuestras ejecuciones, ganando así control y una enorme mejora en los tiempos de respuesta. Tal y como muestran muchos benchmarks realizados con ab parece que <strong>las peticiones atendidas pueden llegar a multiplicarse varias veces</strong>. Para poder hacer alguna prueba vamos a preparar un script para servir <a href="http://www.slimframework.com/" target="_blank" rel="noopener">Slim Framework</a>, ya tengo algunas pequeñas API’s con este framework y así aprovecho y lo utilizo para mis experimentos.</p>
<a id="more"></a>

<h3 id="Instalacion"><a href="#Instalacion" class="headerlink" title="Instalación"></a>Instalación</h3><p>Como casi todo a día de hoy podemos hacer la instalación directamente con <a href="https://www.mercenariophp.com/iniciacion-php-composer/">Composer</a>, lo primero creamos el <a href="https://www.mercenariophp.com/iniciacion-php-composer/">composer.json</a> para el proyecto. Desde bash, en el directorio raíz del proyecto, podemos invocar directamente el comando <code>composer init</code> para inicializar el documento, o generarlo nosotros a mano para después hacer el install de las dependencias. El archivo json debería quedar más o menos parecido a este. Hay que tener en cuenta que yo modifico la ruta de la carpeta <strong>vendor</strong> a fin de tener todo el código PHP bajo un mismo directorio, por lo que añado la clausula config donde indico la nueva ruta.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"mbarquin/react-2-slim"</span>,</span><br><span class="line">    <span class="attr">"description"</span>: <span class="string">"Adaptación de servidor HTTP de reactPHP para Slim Framework"</span>,</span><br><span class="line">    <span class="attr">"require"</span>: &#123;</span><br><span class="line">        <span class="attr">"php"</span>: <span class="string">"^7.0"</span>,</span><br><span class="line">        <span class="attr">"react/http"</span>: <span class="string">"0.3.*"</span>,</span><br><span class="line">        <span class="attr">"slim/slim"</span>: <span class="string">"^3.1"</span>,</span><br><span class="line">        <span class="attr">"monolog/monolog"</span>: <span class="string">"1.0.*"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"config"</span>: &#123;</span><br><span class="line">        <span class="attr">"vendor-dir"</span>: <span class="string">"src/vendor"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"autoload"</span>: &#123;</span><br><span class="line">        <span class="attr">"psr-4"</span>: &#123; <span class="attr">"MyApp\\"</span>: <span class="string">"src/private"</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Ya solo hace falta el comando <code>composer install</code> para descargar las librerías y generar el archivo .lock, despues de esto pasamos a crear el script del servidor.</p>
<h2 id="El-desarrollo"><a href="#El-desarrollo" class="headerlink" title="El desarrollo"></a>El desarrollo</h2><p>Lo primero a tener en cuenta va a ser la forma de trabajo de ambas herramientas, por suerte tienen una dinámica de funcionamiento similar. ReactPHP ejecuta un bucle infinito en espera de una petición, en cuanto llega se ejecuta la closure asociada al evento Request, este callback recibirá como parámetros el objeto Request y Response propios de ReactPHP. Se espera que la respuesta sea inyectada en el objeto Response, las cabeceras se establecen mediante el método <strong>writeHead($responseCode, $headersArray)</strong> y el cuerpo de la respuesta puede escribirse con el método write o directamente como parámetro del método <strong>end($content=null)</strong> que se encarga de dar por terminada la generación del contenido.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Ejemplo básico de ReactPHP</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'../vendor/autoload.php'</span>;</span><br><span class="line"></span><br><span class="line">$app = <span class="function"><span class="keyword">function</span> <span class="params">($request, $response)</span> </span>&#123;</span><br><span class="line">    $response-&gt;writeHead(<span class="number">200</span>, <span class="keyword">array</span>(<span class="string">'Content-Type'</span> =&gt; <span class="string">'text/plain'</span>));</span><br><span class="line">    $response-&gt;end(<span class="string">"Hello World\n"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">$loop = React\EventLoop\Factory::create();</span><br><span class="line">$socket = <span class="keyword">new</span> React\Socket\Server($loop);</span><br><span class="line">$http = <span class="keyword">new</span> React\Http\Server($socket, $loop);</span><br><span class="line"></span><br><span class="line">$http-&gt;on(<span class="string">'request'</span>, $app);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Server running at http://127.0.0.1:1337\n"</span>;</span><br><span class="line"></span><br><span class="line">$socket-&gt;listen(<span class="number">1337</span>);</span><br><span class="line">$loop-&gt;run();</span><br></pre></td></tr></table></figure>

<p>Por su lado, Slim asocia métodos y rutas HTTP a closures que reciben como parámetros los objetos Request y Response propios de Slim, que extienden del interface standard <a href="http://www.php-fig.org/psr/psr-7/" target="_blank" rel="noopener">PSR-7</a>. Al hacer el <strong>run()</strong> de la aplicación, esta se encarga de coger automáticamente los parámetros de la petición de manera habitual para conformar los objetos que se pasan a la closure, que se ejecutará en caso de haber coincidencia con la ruta/método definido.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Ejemplo básico de Slim.</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">'../vendor/autoload.php'</span>;</span><br><span class="line">$app = <span class="keyword">new</span> Slim\App();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Inyectamos una closure para resolver determinadas peticiones GET</span></span><br><span class="line">$app-&gt;get(<span class="string">'/hello/&#123;name&#125;'</span>, <span class="function"><span class="keyword">function</span> <span class="params">($request, $response)</span> </span>&#123;</span><br><span class="line">        $name = $request-&gt;getAttribute(<span class="string">'name'</span>);</span><br><span class="line">        $response-&gt;getBody()-&gt;write(<span class="string">"Hello, $name"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $response;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">$app-&gt;run();</span><br></pre></td></tr></table></figure>

<h2 id="Script-de-servidor"><a href="#Script-de-servidor" class="headerlink" title="Script de servidor"></a>Script de servidor</h2><p><img src="/images/reactslim/directory-tree-reactphp-slim.png" alt></p>
<p>Sencillamente vamos a asociar una closure al servidor ReactPHP que se encargará de que Slim procese la petición, pasará los datos de los objetos de React a Slim y ejecutará el proceso que atravesando todo el middleware resuelva el callback asociado a la ruta. Aprovecharemos la función <strong>process</strong> que es el núcleo del método <strong>run()</strong> y nos permite ejecutar Slim con el Request y Response que nosotros le inyectemos, sin que el framework los genere para nosotros.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">'../vendor/autoload.php'</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">MyApp</span>\<span class="title">Http</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generamos una nueva instancia de Slim</span></span><br><span class="line">$app = <span class="keyword">new</span> \Slim\App();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Añadimos una closure para atender determinadas peticiones GET</span></span><br><span class="line">$app-&gt;get(<span class="string">'/hello/&#123;name&#125;'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        \MyApp\Http\Request $request,</span></span></span><br><span class="line"><span class="function"><span class="params">        \MyApp\Http\Response $response)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        $name = $request-&gt;getAttribute(<span class="string">'name'</span>);</span><br><span class="line">        $response-&gt;getBody()-&gt;write(<span class="string">"Hello, $name"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $response;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Creamos otra closure para resolver las requests.</span></span><br><span class="line">$serverCallback = <span class="function"><span class="keyword">function</span> <span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">       \React\Http\Request $request,</span></span></span><br><span class="line"><span class="function"><span class="params">       \React\Http\Response $response)</span> <span class="title">use</span> <span class="params">($app)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    $slRequest  = \MyApp\Http\Request::createFromReactRequest($request);</span><br><span class="line">    $slResponse = <span class="keyword">new</span> \MyApp\Http\Response();</span><br><span class="line"></span><br><span class="line">    $app-&gt;process($slRequest, $slResponse);</span><br><span class="line"></span><br><span class="line">    $slResponse-&gt;setReactResponse($response, <span class="keyword">true</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Hacemos el setup y levantamos el servidor React</span></span><br><span class="line">$loop   = React\EventLoop\Factory::create();</span><br><span class="line">$socket = <span class="keyword">new</span> React\Socket\Server($loop);</span><br><span class="line">$http   = <span class="keyword">new</span> React\Http\Server($socket, $loop);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Ligamos la closure al evento request.</span></span><br><span class="line">$http-&gt;on(<span class="string">'request'</span>, $serverCallback);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Server running at http://127.0.0.1:1337\n"</span>;</span><br><span class="line"></span><br><span class="line">$socket-&gt;listen(<span class="number">1337</span>);</span><br><span class="line">$loop-&gt;run();</span><br></pre></td></tr></table></figure>

<p>Como se puede ver aquí mezclamos ambos códigos, por un lado hacemos el setup de Slim ($app) básico para atender determinadas peticiones GET. Creamos el callback de ReactPHP encargado de recibir el evento request y replicar la llamada al framework Slim. Desde esta closure le inyectamos como parámetros unos objetos Request y Response customizados que hemos extendido directamente de los nativos de Slim. Solamente para añadirles unas funciones que permitan trasladar los datos entre ambos sistemas, por lo que deberían funcionar exactamente igual. Estos extenderían los mismos interfaces que los nativos de Slim por lo que no debería haber problemas al atravesar la estructura del framework. Todavía faltan cosas por hacer, como trasladar la información del Body, las Cookies o los ficheros subidos por las Requests, intentaré pasar  estos objetos a Github a fin de seguir haciendo algunos tests e intentaré implementar las cosas que faltan, pero para nuestro ejemplo actual, con esto llega. Tras definir este callback parametrizamos y hacemos el <strong>run()</strong> del servidor.</p>
<p>Con esto solo nos queda ejecutar el script para que se quede escuchando igual que lo haría apache o nginx, lanzamos el comando <code>php server.php</code> en la misma carpeta que se encuentra el fuente y abrimos en el navegador la url <a href="http://localhost:1337/hello/Moi" target="_blank" rel="noopener">http://localhost:1337/hello/Moi</a>. Hay que tener cuidado de llamar a esta ruta ya que es la única que va a devolver resultados.</p>
<h2 id="Extendiendo-la-request"><a href="#Extendiendo-la-request" class="headerlink" title="Extendiendo la request"></a>Extendiendo la request</h2><p>Para la Request he generado un método estático para alimentar la instancia de Slim, de la misma manera que en el objeto origen tienen el método estático <strong>createFromEnvironment</strong>.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MyApp</span>\<span class="title">Http</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Slim</span>\<span class="title">Http</span>\<span class="title">Headers</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Slim</span>\<span class="title">Http</span>\<span class="title">Uri</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Slim</span>\<span class="title">Http</span>\<span class="title">RequestBody</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">React</span>\<span class="title">Http</span>\<span class="title">Request</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Request</span> <span class="keyword">extends</span> \<span class="title">Slim</span>\<span class="title">Http</span>\<span class="title">Request</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">createFromReactRequest</span><span class="params">(\React\Http\Request $request)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $slimHeads = <span class="keyword">new</span> Headers();</span><br><span class="line">        <span class="keyword">foreach</span>($request-&gt;getHeaders() <span class="keyword">as</span> $reactHeadKey =&gt; $reactHead) &#123;</span><br><span class="line">            $slimHeads-&gt;add($reactHeadKey, $reactHead);</span><br><span class="line">            <span class="keyword">if</span>($reactHeadKey === <span class="string">'Host'</span>) &#123;</span><br><span class="line">                $host = explode(<span class="string">':'</span>, $reactHead);</span><br><span class="line">                <span class="keyword">if</span>(count($host) === <span class="number">1</span>) &#123;</span><br><span class="line">                    $host[<span class="number">1</span>] = <span class="string">'80'</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $slimUri = <span class="keyword">new</span> Uri(<span class="string">'http'</span>, $host[<span class="number">0</span>], (int)$host[<span class="number">1</span>], $request-&gt;getPath(), $request-&gt;getQuery());</span><br><span class="line"></span><br><span class="line">        $cookies = [];</span><br><span class="line">        $serverParams = $_SERVER;</span><br><span class="line">        $serverParams[<span class="string">'SERVER_PROTOCOL'</span>] = <span class="string">'HTTP/'</span>.$request-&gt;getHttpVersion();</span><br><span class="line"></span><br><span class="line">        $slimBody = <span class="keyword">new</span> RequestBody();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">self</span>(</span><br><span class="line">                $request-&gt;getMethod(), $slimUri, $slimHeads, $cookies,</span><br><span class="line">                $serverParams, $slimBody</span><br><span class="line">            );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Extendiendo-la-response"><a href="#Extendiendo-la-response" class="headerlink" title="Extendiendo la response"></a>Extendiendo la response</h2><p>A la Reponse, a través de herencia, le añadimos el método público <strong>setReactResponse($response, $endResponse=false)</strong> con el que traspasamos la información del objeto actual al objeto \React\Http\Response que va a transmitir el resultado de la operación al cliente. Como primer parámetro le pasaremos la Response de ReactPHP, que nos llega como parámetro de la closure, para inyectarle los datos del resultado. Y, como segundo parámetro le facilitaremos un booleano para indicar la ejecución del método <strong>end()</strong> de la Response React. Con esto cerramos la transmisión y volcamos el contenido al navegador.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MyApp</span>\<span class="title">Http</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Response</span> <span class="keyword">extends</span> \<span class="title">Slim</span>\<span class="title">Http</span>\<span class="title">Response</span></span></span><br><span class="line"><span class="class"> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setReactResponse</span><span class="params">(\React\Http\Response $reactResp, $endRequest = false)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $reactResp-&gt;writeHead(<span class="keyword">$this</span>-&gt;getStatusCode(), <span class="keyword">$this</span>-&gt;getHeaders());</span><br><span class="line">        $reactResp-&gt;write(<span class="keyword">$this</span>-&gt;getBody());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($endRequest === <span class="keyword">true</span>) &#123;</span><br><span class="line">            $reactResp-&gt;end();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Y-aqui-estamos"><a href="#Y-aqui-estamos" class="headerlink" title="Y aqui estamos"></a>Y aqui estamos</h2><p>Con esto tenemos una setup básica con la que utilizar Slim en conjunción con ReactPHP, de momento React es alpha y no apto para ser usado en producción, de verdad tengo ganas de ver la release estable y empezar a trabajar de forma habitual con él, las ventajas que plantea son muy similares a las que han posicionado tan bien a NodeJs en tan poco tiempo aunque no debemos perder de vista sus limitaciones.</p>
<ul>
<li>Este sistema deberá ser reiniciado tras hacer cualquier cambio en los fuentes</li>
<li>Si realmente queremos tener un sistema eficiente deberíamos balancear diferentes instancias tras un nginx (p.e.) para optimizar el rendimiento de la máquina.</li>
<li>La forma de trabajar de muchos de los frameworks actuales puede no ser compatible con la forma de trabajo de ReactPHP (Slim o Symfony parecen no dar problemas).</li>
<li>Una exception no tratada o cualquier error inesperado puede detener el servidor.</li>
</ul>
<p>En mis tiempos libres intentaré completar los sources para transmitir correctamente las Cookies, los archivos subidos y el contenido del Body, en cuanto pueda crearé un proyecto en Github para poder mejorar y utilizar estos fuentes.</p>
</div><div class="tags"><a href="/tags/PHP/">PHP</a><a href="/tags/Herramientas/">Herramientas</a><a href="/tags/ReactPHP/">ReactPHP</a><a href="/tags/Slim/">Slim</a></div><div class="post-nav"><a href="/versionado-semantico/" class="pre"><i class="icon-previous">Versionado semántico, identifica correctamente tus releases</i></a><a href="/tutorial-php-composer/" class="next">Tutorial, Composer el gestor de dependencias PHP<i class="icon-next"></i></a></div><div id="disqus_thread"><script>var disqus_shortname = 'mercenariophp';
var disqus_identifier = 'slim-reactphp-servidor-nativo/';
var disqus_title = 'ReactPHP, servidor nativo PHP y Slim framework';
var disqus_url = 'https://www.mercenariophp.com/slim-reactphp-servidor-nativo/';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//mercenariophp.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search" class="search-form-input"><input type="hidden" name="sitesearch" value="https://www.mercenariophp.com"></form></div><div class="widget lessMargin"><div style="text-align: left;"><div style="width: 84px; height: 40px;"><a href="https://twitter.com/mercenariophp" rel="nofollow" target="_blank" class="twitter_big"></a><a href="https://es.linkedin.com/in/moisés-barquín-salgado-b6148296" rel="nofollow" target="_blank" class="linkedin_big"></a></div></div></div><div class="widget"><div class="widget-title">Categorías</div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Desarrollo/">Desarrollo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tutoriales-Symfony/">Tutoriales Symfony</a></li></ul></div><div class="widget"><div class="widget-title">Etiquetas</div><div class="tagcloud"><a href="/tags/tests/" style="font-size: 15px;">tests</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a> <a href="/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/tags/Laravel/" style="font-size: 15px;">Laravel</a> <a href="/tags/PagesGenerator/" style="font-size: 15px;">PagesGenerator</a> <a href="/tags/Herramientas/" style="font-size: 15px;">Herramientas</a> <a href="/tags/Tutorial/" style="font-size: 15px;">Tutorial</a> <a href="/tags/PHPUnit/" style="font-size: 15px;">PHPUnit</a> <a href="/tags/Composer/" style="font-size: 15px;">Composer</a> <a href="/tags/NetBeans/" style="font-size: 15px;">NetBeans</a> <a href="/tags/IDE/" style="font-size: 15px;">IDE</a> <a href="/tags/ReactPHP/" style="font-size: 15px;">ReactPHP</a> <a href="/tags/Slim/" style="font-size: 15px;">Slim</a> <a href="/tags/SQL/" style="font-size: 15px;">SQL</a> <a href="/tags/Pattern/" style="font-size: 15px;">Pattern</a> <a href="/tags/Repositorio/" style="font-size: 15px;">Repositorio</a> <a href="/tags/Frameworks/" style="font-size: 15px;">Frameworks</a></div></div><div class="widget"><div class="widget-title">Recientes</div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/php-dotenv-variables-entorno/">PHP Dotenv, configuración en variables de entorno</a></li><li class="post-list-item"><a class="post-list-link" href="/vacaciones/">Vacaciones</a></li><li class="post-list-item"><a class="post-list-link" href="/retornando-objetos-valor/">Retornando objetos de valor en lugar de arrays</a></li><li class="post-list-item"><a class="post-list-link" href="/tutorial-symfony-bundles-knpmenubundle/">Tutorial de Symfony 3: Bundles y KnpMenuBundle</a></li><li class="post-list-item"><a class="post-list-link" href="/descarga-ficheros-comprimidos-Archivestream-php/">Descarga de ficheros comprimidos con ArchiveStream-php</a></li><li class="post-list-item"><a class="post-list-link" href="/tutorial-symfony-doctrine-orm/">Tutorial de Symfony 3: Doctrine ORM y Base de Datos</a></li><li class="post-list-item"><a class="post-list-link" href="/tutorial-symfony-twig/">Tutorial de Symfony 3: Twig, base layout con Bootstrap</a></li><li class="post-list-item"><a class="post-list-link" href="/tutorial-symfony/">Tutorial de Symfony 3: Instalación, routing y controllers</a></li><li class="post-list-item"><a class="post-list-link" href="/refactorizando-reactphp-slim/">Refactorizando reactphp-slim</a></li><li class="post-list-item"><a class="post-list-link" href="/editor-hackeable-atom/">Editor hackeable Atom, el editor para el siglo 21</a></li></ul></div><div class="widget"><div class="widget-title">Comentarios recientes</div><script type="text/javascript" src="//mercenariophp.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title">Blogroll</div><ul></ul><a href="http://www.phptherightway.com/" title="PHP The Right Way" target="_blank">PHP The Right Way</a></div></div></div></div><div id="footer"><a href="https://twitter.com/mercenariophp" rel="nofollow" class="twitter"></a> <a href="https://es.linkedin.com/in/moisés-barquín-salgado-b6148296" rel="nofollow" class="linkedin"></a> © <a href="/." rel="nofollow">mercenariophp.</a> With<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/jquery.min.js?v=0.0.0"></script><script type="text/javascript" src="/js/totop.js?v=0.0.0"></script><script type="text/javascript" src="/js/fancybox.pack.js?v=0.0.0"></script><script type="text/javascript" src="/js/jquery.fancybox.js?v=0.0.0"></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-78289384-1','auto');ga('send','pageview');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>